[platformio]
include_dir = include

; Choose which environment to build by default
; - esp32dev : ESP32 devkit (development / main target)
; - esp12f : ESP-12F (ESP8266 production variant)
default_envs = esp32dev

; ---------- COMMON SETTINGS FOR ALL ENVS ----------
[env]
framework = arduino
monitor_speed = 115200

; Common libraries used by firmware
lib_deps =
    bblanchon/ArduinoJson@^7.4.2
    adafruit/Adafruit PN532@^1.3.4
    knolleary/PubSubClient@^2.8

build_unflags =
    -std=gnu++11
    -std=gnu++14
    -std=gnu++17

build_flags =
    -std=gnu++20
    -DNFC_INTERFACE_SPI

; ============================================================
; DEV: ESP32 DEVKIT
; ============================================================
[env:esp32dev]
platform = https://github.com/tasmota/platform-espressif32/releases/download/2025.11.31/platform-espressif32.zip
board = esp32dev
board_build.partitions = partitions_ota_esp32.csv

; Dev: verbose logging, target define for conditional code
build_flags =
    ${env.build_flags}
    -DCORE_DEBUG_LEVEL=ARDUHAL_LOG_LEVEL_DEBUG
    -DHW_TARGET_ESP32

; ============================================================
; PROD: ESP-12F (ESP8266) uses the same board definition as esp12e
; ============================================================
[env:esp12f]
platform = https://github.com/tasmota/platform-espressif8266/releases/download/2025.10.00/platform-espressif8266.zip
board = esp12e

; 4MB flash, 1MB FS â€“ OTA-friendly layout
board_build.flash_mode = dio
board_build.flash_size = 4MB
board_build.ldscript = eagle.flash.4m1m.ld
board_build.filesystem = spiffs   ; or littlefs if you prefer

; Prod: less logging, ESP8266-specific and PROD define
build_flags =
    ${env.build_flags}
    -DCORE_DEBUG_LEVEL=ARDUHAL_LOG_LEVEL_ERROR
    -DHW_TARGET_ESP8266
    -DPROD_BUILD
